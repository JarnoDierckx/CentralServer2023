<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Create</title>
</h:head>
<h:body>
    <h:outputStylesheet library="css" name="create.css"/>
<div class="card">
    <h:form styleClass="grid">
        <div class="CS2023Container">
            <section >
                <h:outputText value="Contract number"/><br/>
                <p:inputText value="#{contractBean.newContract.contract_number}" required="true"/>
            </section>

            <section>
                <h:outputText value="Client"/><br/>
                <p:selectOneMenu value="#{contractBean.newContract.client_id}">
                    <f:selectItems value="#{contractBean.clients}" var="c" itemLabel="#{c.name}" itemValue="#{c.DBB_ID}"/>
                </p:selectOneMenu>
            </section>

            <section>
                <h:outputText value="BRJ"/><br/>
                <p:selectOneMenu value="#{contractBean.newContract.bjr_id}">
                    <f:selectItems value="#{contractBean.bjrs}" var="b" itemLabel="#{b.name}" itemValue="#{b.id}"/>
                </p:selectOneMenu>
            </section>

            <section>
                <h:outputText value="Start Date"/><br/>
                <p:calendar  value="#{contractBean.newContract.start_date}" pattern="yyyy-MM-dd">
                    <f:convertDateTime pattern = "yyyy-MM-dd" />
                </p:calendar>
            </section>

            <section>
                <h:outputText value="End Date"/><br/>
                <p:calendar  value="#{contractBean.newContract.end_date}" pattern="yyyy-MM-dd">
                    <f:convertDateTime pattern = "yyyy-MM-dd" />
                </p:calendar>
            </section>

            <section>
                <h:outputText value="Source"/><br/>
                <p:inputText value="#{contractBean.newContract.source}"/>
            </section>

            <section>
                <h:outputText value="Invoice frequency"/><br/>
                <p:inputText value="#{contractBean.newContract.invoice_frequency}" required="true"/>
            </section>

            <section>
                <h:outputText value="Index frequency"/><br/>
                <p:inputText value="#{contractBean.newContract.index_frequency}" required="true"/>
            </section>

            <section>
                <h:outputText value="Base index year"/><br/>
                <p:inputText value="#{contractBean.newContract.base_index_year}"/>
            </section>

            <section>
                <h:outputText value="Index start"/><br/>
                <p:inputText value="#{contractBean.newContract.index_start}" required="true"/>
            </section>

            <section>
                <h:outputText value="Index last invoice"/><br/>
                <p:inputText value="#{contractBean.newContract.index_last_invoice}"/>
            </section>

            <section>
                <h:outputText value="Amount last invoice"/><br/>
                <p:inputText value="#{contractBean.newContract.amount_last_invoice}"/>
            </section>

            <section>
                <h:outputText value="Last invoice number"/><br/>
                <p:inputText value="#{contractBean.newContract.last_invoice_number}"/>
            </section>

            <section>
                <h:outputText value="Last invoice date"/><br/>
                <p:calendar  value="#{contractBean.newContract.last_invoice_date}" pattern="yyyy-MM-dd">
                    <f:convertDateTime pattern = "yyyy-MM-dd" />
                </p:calendar>
            </section>

            <section>
                <h:outputText value="Last invoice period start"/><br/>
                <p:calendar  value="#{contractBean.newContract.last_invoice_period_start}" pattern="yyyy-MM-dd">
                    <f:convertDateTime pattern = "yyyy-MM-dd" />
                </p:calendar>
            </section>

            <section>
                <h:outputText value="Last invoice period end"/><br/>
                <p:calendar  value="#{contractBean.newContract.last_invoice_period_end}" pattern="yyyy-MM-dd">
                    <f:convertDateTime pattern = "yyyy-MM-dd" />
                </p:calendar>
            </section>

            <section>
                <h:outputText value="jgr"/><br/>
                <p:inputText value="#{contractBean.newContract.jgr}"/>
            </section>
        </div>
        <div>
            <p:dataTable id="detailsTable" var="detail" value="#{contractBean.contractDetailsList}" editable="true" editMode="cell">

                <p:column headerText="Module id">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{detail.moduleId.name}"/>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{detail.moduleId.name}" style="width:100%"/>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="purchase date">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{detail.purchase_Date}">
                                <f:convertDateTime pattern = "yyyy-MM-dd" />
                            </h:outputText>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{detail.purchase_Date}" style="width:100%">
                                <f:convertDateTime pattern = "yyyy-MM-dd" />
                            </p:inputText>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="amount">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{detail.amount}"/>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{detail.amount}" style="width:100%"/>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="purchase price">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{detail.purchase_price}"/>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{detail.purchase_price}" style="width:100%"/>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="index start">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{detail.index_Start}"/>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{detail.index_Start}" style="width:100%"/>
                        </f:facet>
                    </p:cellEditor>
                </p:column>

                <p:column headerText="renewal">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{detail.renewal}"/>
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{detail.renewal}" style="width:100%"/>
                        </f:facet>
                    </p:cellEditor>
                </p:column>
            </p:dataTable>
            <p:commandButton title="Add detail" process="@this" oncomplete="PF('detailsTable').addRow();">
                <f:ajax listener="#{contractBean.addContractDetail}"/>
            </p:commandButton>
        </div>
        <p:commandButton value="Create" action="#{contractBean.createContract}"/>
    </h:form>
</div>

</h:body>
</html>